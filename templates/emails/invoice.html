{% extends "emails/base.html" %}

{% block title %}Invoice from Worker Connect{% endblock %}

{% block content %}
<h2>Invoice #{{ invoice.invoice_number }}</h2>

<p>Hi {{ client_name }},</p>

<p>You have received an invoice from {{ worker_name }} for services rendered.</p>

<div class="details-list">
    <div class="item">
        <span class="label">Invoice Number</span>
        <span class="value">{{ invoice.invoice_number }}</span>
    </div>
    <div class="item">
        <span class="label">Issue Date</span>
        <span class="value">{{ invoice.issue_date|date:"M d, Y" }}</span>
    </div>
    <div class="item">
        <span class="label">Due Date</span>
        <span class="value">{{ invoice.due_date|date:"M d, Y" }}</span>
    </div>
    {% if invoice.job %}
    <div class="item">
        <span class="label">Related Job</span>
        <span class="value">{{ invoice.job.title }}</span>
    </div>
    {% endif %}
</div>

<h3>Invoice Details</h3>

<table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
    <thead>
        <tr style="background-color: #f3f4f6;">
            <th style="padding: 12px; text-align: left; border-bottom: 2px solid #e5e7eb;">Description</th>
            <th style="padding: 12px; text-align: right; border-bottom: 2px solid #e5e7eb;">Qty</th>
            <th style="padding: 12px; text-align: right; border-bottom: 2px solid #e5e7eb;">Rate</th>
            <th style="padding: 12px; text-align: right; border-bottom: 2px solid #e5e7eb;">Amount</th>
        </tr>
    </thead>
    <tbody>
        {% for item in invoice.items.all %}
        <tr>
            <td style="padding: 12px; border-bottom: 1px solid #e5e7eb;">{{ item.description }}</td>
            <td style="padding: 12px; text-align: right; border-bottom: 1px solid #e5e7eb;">{{ item.quantity }}</td>
            <td style="padding: 12px; text-align: right; border-bottom: 1px solid #e5e7eb;">${{ item.unit_price }}</td>
            <td style="padding: 12px; text-align: right; border-bottom: 1px solid #e5e7eb;">${{ item.total }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<div class="details-list" style="background-color: #f0f9ff;">
    <div class="item">
        <span class="label">Subtotal</span>
        <span class="value">${{ invoice.subtotal }}</span>
    </div>
    {% if invoice.tax_amount %}
    <div class="item">
        <span class="label">Tax ({{ invoice.tax_rate }}%)</span>
        <span class="value">${{ invoice.tax_amount }}</span>
    </div>
    {% endif %}
    {% if invoice.discount %}
    <div class="item">
        <span class="label">Discount</span>
        <span class="value">-${{ invoice.discount }}</span>
    </div>
    {% endif %}
    <div class="item" style="font-size: 18px;">
        <span class="label"><strong>Total Due</strong></span>
        <span class="value"><strong>${{ invoice.total }}</strong></span>
    </div>
</div>

{% if invoice.notes %}
<div class="info-box">
    <h3>Notes</h3>
    <p>{{ invoice.notes }}</p>
</div>
{% endif %}

<p style="text-align: center;">
    <a href="{{ payment_url }}" class="btn">Pay Now</a>
    <a href="{{ invoice_url }}" class="btn btn-secondary" style="margin-left: 10px;">View Invoice</a>
</p>

<p style="color: #6b7280; font-size: 13px;">
    {{ invoice.terms|default:"Payment is due within 30 days of the invoice date." }}
</p>

<p>Best regards,<br>
<strong>{{ worker_name }}</strong></p>
{% endblock %}
